<!DOCTYPE html>
<html lang="en">
<head>
<link rel="stylesheet" type="text/css" href="sssAlgorithm.css">
<title>Shamir's Secret Sharing Algorithm</title>
<script id="MathJax-script" async src="${JCTJS_HOST}/javascript/MathJax-master/es5/tex-mml-svg.js"></script>
</head>
<body>
  <h1>Shamir's Secret Sharing Algorithm</h1>

  <p>Shamir's Secret Sharing algorithm was developed in 1979 by Adi Shamir as a secret sharing method
    which allows to distribute shares of a secret among several people, and only a subset of them is needed to
    reconstruct the secret.You can compare this with a vault where 3 of 5 different keys are sufficient to
    open it.</p>

  <p>Let \(n\) and \(t\) be natural numbers with \(t \leq n\). In a \((n,t)\)-Secret-Sharing-Protocol is
    shared the secret to n people. Every person has a share of the secret. If \(t\) of these people get
    together they can reconstruct the secret. If less than \(t\) together this part secret information they
    can not obtain relevant information about the secret. This principle is much better than cutting a
    treasure map into pieces and distribute the pieces to several people.</p>

  <p>Shamir's algorithm uses the Lagrange interpolation in order to reconstruct the polynomial. All
    calculations are carried out in the finite field \(\mathbb {Z} /p\mathbb {Z}\) (Integer modulo a prime
    number).</p>

  <p>Given, the dealer is the one who wants to distribute a secret \(s \in \mathbb {Z} /p\mathbb {Z}\).</p>

  <p>In order to reconstruct the secret, we have to apply the lagrange polynomial interpolation for which
    we use the points known by shareholders.
  <h2>Lagrange polynomial interpolation</h2>

  <p>The aim of a Lagrange polynomial is to approximate (interpolate) points between known, original
    points in a coordinate system. The underlying function of the original points is unknown.</p>

  <p>We construct supports called Lagrange basis polynomials \(L_i\) for each known point \(i\). These
    supports are calculated to be exactly 1 for their corresponding point \(i\), all the other points \(j\)
    are included as well for the interpolation for all \(t\) points.</p>

  <p style="margin-left: 20pt">\( \begin{align}
    L_i(x) = \prod\limits_{j \neq i}\frac{x - x_j}{x_j - x_i}, \quad i = 1, ..., t
  \end{align} \)</p>

  <p>
    On first glance this may seem intimidating, so let's take a closer look. The exception that for the
    \(i\)-th support the point \(i\) must be excluded, is simply to prevent a division by zero: if \(x_i =
    x_j\) then \(\frac{x - x_i}{x_j - x_i} = \frac{x - x_i}{0}\).<br>
  <p>If we expand the formula for a concrete example, it should become clearer. Let's assume we have 3
    points, that means we need 3 Lagrange polynomials \(L_i\):</p>

  <p style="margin-left: 20pt">\( \begin{align}
    L_1(x) = \frac{x - x_2}{x_2 - x_1} \cdot \frac{x - x_3}{x_3 - x_1}\\
    L_2(x) = \frac{x - x_1}{x_1 - x_2} \cdot \frac{x - x_3}{x_3 - x_2}\\
    L_3(x) = \frac{x -  x_1}{x_1 - x_3} \cdot \frac{x - x_2}{x_2 - x_3}
  \end{align} \)</p>

  <p>The y-value of a point to be interpolated \(x\) (note that this is a variable, while \(x_i\) and
    \(x_j\) are given, fixed points) can be interpolated via this formula:</p>

  <p style="margin-left: 20pt">\( \begin{align} P'(x) = \sum L_i(x) \cdot y_i \end{align} \)</p>

  <p>Expanded again for our example with 3 points this means:</p>

  <p style="margin-left: 20pt">\( \begin{align}
    P'(x) = L_1(x) \cdot y_1 + L_2(x) \cdot y_2 + L_3(x) \cdot  y_3
  \end{align} \)</p>

  <p>One requirement for our support polynomials was to be exactly 1 for its corresponding point. We can
    see what happens if we try to interpolate the known point \(x_2\):</p>

  <p style="margin-left: 20pt">\( \begin{align}
    P'(x_2) &= L_1(x_2) \cdot y_1 + L_2(x_2) \cdot y_2 + L_3(x_2) \cdot y_3 = \\[10pt]
    P'(x_2) &= \frac{x_2 - x_2}{x_2 - x_1} \cdot \frac{x_3 - x_1}{x_3 - x_1} \cdot y_1 +
      \frac{x_2 - x_1}{x_2 - x_1} \cdot \frac{x_2 - x_3}{x_3 - x_1} \cdot y_2 + \frac{x_2 - x_1}
      {x_2 - x_1} \cdot \frac{x_2 - x_2}{x_3 - x_1} \cdot y_3 =\\[10pt]
    P'(x_2) &= \frac{0}{x_2 - x_1} \cdot \frac{x_3 - x_1}{x_3 - x_1} \cdot y_1 + \frac{x_2 - x_1}
      {x_2 - x_1} \cdot \frac{x_2 - x_3}{x_3 - x_1} \cdot y_2 + \frac{x_2 - x_1}
      {x_2 - x_1} \cdot \frac{0}{x_3 - x_1} \cdot y_3 =\\[10pt]
    P'(x_2) &= 0 \cdot y_1 + 1 \cdot y_2 + 0 \cdot y_3 = y_2
  \end{align} \)</p>

  <p>\(x_2\) becomes 1, while all other point's influence vanishes by becoming 0. This is the same for all
    known points put into the interpolation. However, if we use an unknown x-value, we will receive an
    interpolated value.</p>

  <h2>Reconstruction of the secret with the Lagrange polynomial interpolation</h2>

  <p>We can now apply the Lgrange interpolation in order to reconstruct the secret. We can see, that the
    secret is the first coefficient of unknown (secret) polynomial of the dealer:</p>

  <p style="margin-left: 20pt">\( \begin{align}
    P(x) = a_0 + a_1 x + a_2 x^2 + ... + a_i x^i
  \end{align}\)</p>

  <p>How can we calculate the secret via the polynomial interpolation? The coefficient \(a_0\) is the only
    point which is not multiplied by \(x\). You can see, that all other terms of the polynomial vanish, when x
    becomes zero. Only the secret remains.</p>

  <p style="margin-left: 20pt">\( \begin{align}
    P(0) &= a_0 + a_1 \cdot 0 + a_2 \cdot 0^2 + ... + a_i \cdot 0 ^ i\\
    P(0) &= a_0 = s
  \end{align} \)</p>

  <p>We now apply this knowledge to calculate the secret \(s\) from the shares. First, we have to
    calculate the Lagrange polynomials \(L_i\). But we have to be careful: as we are using modular arithmetic
    in a finite field, we cannot just divide by numbers. Instead, we have to calculate the modular inverse via
    the extended Euclidean algorithm.</p>

  <p style="margin-left: 20pt">\( \begin{align}
    L_i = \prod\limits_{i \neq j} (x_j - x) \cdot (x_j - x_i)^{-1} \mod p, \quad i = 1, ..., t
  \end{align} \)</p>

  <p>As we are only looking for the point where \(x = 0\), we can simplify the formula \((x_j - x) \cdot
    (x_j - x_i)^{-1}\) to \(x_j \cdot (x_j - x_i)^{-1}\).</p>

  <p>With the Lagrange basis polynomials, we can interpolate the point at \(x = 0\).</p>

  <p style="margin-left: 20pt">\( \begin{align}
    a_0 = s = P'(0) = \sum L_i(0) \cdot y_i
  \end{align} \)</p>


  <h2>Example</h2>

  <p>Let \(n = 4\), \(t = 3\). The dealer chooses \(p = 17\), \(x_i = i\) for each \(i\), \(1 \leq i \leq
    5\). The secret is \(s = 5\). The dealer chooses the secret coefficients \(a_1 = 7\) und \(a_2 = 11\).
    Thus we obtain the polynomial.</p>

  <p style="margin-left: 20pt">\( \begin{align} P(x) = 5 + 7x + 11x^2 \mod 17 \end{align} \)</p>

  <p>
    Using \(x = 1, ..., 4\) the shares are \(y_1 = P(1) = 6\), \(y_2 = P(2) = 12\), \(y_3 = P(3) = 6\), \(y_4
    = P(4) = 5\). These are distributed to the shareholders.</p>

  <figure style="width: 65%; min-width: 250px; max-width: 1000px; margin-bottom: 30pt">
    <img src="sssAlgorithm_fig1-example-plotted.svg"
      alt="Plot of the example polynomial. The secret s, the shares and other points are delineated.">
    <figcaption>Figure 1: Plot of the polynomial. It shows the secret \(s\) at \(x = 0\), the
      shares and other, not relevant points on the polynomial. Note that the continuous blue line is a
      visual help. The secret sharing method works on integer numbers of the finite field which are
      highlighted.</figcaption>
  </figure>

  <p>The shareholders 1, 2, and 3 now come together to reconstruct the secret. The Lagrange basis
    polynomials are calculated:</p>

  <p style="margin-left: 20pt">\( \begin{align}
    L_i(x) = \prod\limits_{j \neq i} x \cdot (x_j - x_i)^{-1}, \quad i = 1, ... , t
  \end{align} \)</p>

  <p style="margin-left: 20pt">\( \begin{alignat}{11}
    L_1(0) &&= 2 \cdot (2 - 1)^{-1} \cdot 3 \cdot (3 - 1)^{-1} =&& (2 \cdot 1) &\cdot (3 \cdot 9)
      &&=& \, 3 \;\; &(\text{mod} \; p)\\
    L_2(0) &&= 1 \cdot (1 - 2)^{-1} \cdot 3 \cdot (3 - 2)^{-1} =&& \ (1 \cdot 16) &\cdot (3 \cdot 1)
      &&=& \, 14 \;\; &(\text{mod} \;p)\\
    L_3(0) &&= 1 \cdot (1 - 3)^{-1} \cdot 2 \cdot (2 - 3)^{-1} =&& (1 \cdot 8) &\cdot (2 \cdot 16) 
      &&=& \, 1 \;\; &(\text{mod} \; p)\\
  \end{alignat} \)</p>

  <p style="margin-left: 20pt">\( \begin{alignat}{2}
    L_1(0) =&& 3 \\
    L_2(0) =&& \, 14 \\
    L_3(0) =&& 1
  \end{alignat} \)</p>

  <p>As a little help, the modular inverse results of the extended Euclidean algorithm are:</p>

  <p style="margin-left: 20pt">\( \begin{align}
    2^{-1} &= 9 \; &(\textrm{mod} \; 17)\\
    1^{-1} &= 1 \; &(\textrm{mod} \; 17)\\
    -1^{-1} &= 16^{-1} = 16 \; &(\textrm{mod} \; 17)
  \end{align} \)</p>

  <p>We use the Lagrange basis polynomials to reconstruct \(s\):</p>

  <p style="margin-left: 20pt; margin-bottom: 30pt">\( \begin{align}
    s = \sum L_i(0) \cdot y_i \quad \mod p
  \end{align} \)</p>

  <p style="margin-left: 20pt">\( \begin{alignat}{14}
    s =&& L_1(0) \, \cdot& \, y_1 \, &+&&\ L_2(0) \, \cdot&& \, y_2 \, +&& \, L_3(0) \, \cdot& \,
      y_3 &\mod 17 \\[5pt]
    s =&& L_1(0) \, \cdot& \, 6 \, &+&&\ L_2(0) \, \cdot&& \, 12 \, +&& \, L_3(0) \, \cdot& \,
      6 &\mod 17 \\[5pt]
    s =&& 3 \, \cdot& \, 6 \, &+&&\ 14 \, \cdot&& \, 12 \, +&& \, 1 \, \cdot& \, 6 &\mod 17 \\[5pt]
    s =&& 18 & &+&& 168 && +&& 6 & &\mod 17 \\[5pt]
    s =&& & & && 192 && && & &\mod 17 \\[5pt] s =&& & & && 5 && && & &\mod 17 
  \end{alignat} \)</p>

  <p><b>\(s = 5\)</b> is the correctly reconstructed secret.</p>

  <figure style="width: 65%; min-width: 250px; max-width: 1000px">
    <img src="sssAlgorithm_fig2-example-plotted-with-interpolation.svg"
      alt="Plot of the example polynomial. Additionally to above figure, the interpolated polynomial is also plotted.
           Both intersect at the secret point at x = 0.">
    <figcaption>Figure 2: Additionally, the interpolated polynomial \(P'(x)\) is plotted. You
      can see how both intersect at the point of the secret \(x = 0\). Again, the continuous representation
      of the polynomials as line is only a conceptual and visual support.</figcaption>
  </figure>
  
<h3>Literature</h3>
<p>[1] Johannes Buchmann: Einführung in die Kryptografie, 4., edition 2008, Chapter 16, Page 243</p>

</body>
</html>
